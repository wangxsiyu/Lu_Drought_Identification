axis(side = 2, las = 1)
box()
legend(0,0.6, legend = toupper(vegname[i]), bty = "n")
}
?text
seq(1.5,11.5,1)[-c(4,8)]
head(data$obs)
text(x = seq(1.5,11.5,1)[-c(4,8)],
y = par("usr")[3] - 0.5,
labels = rep(c("f001","f002","x9472050"),each = 3),
xpd = NA,
## Rotate the labels by 35 degrees.
srt = 35,
adj = 0.8,
cex = 1.2)
text(x = seq(1.5,11.5,1)[-c(4,8)],
labels = rep(c("f001","f002","x9472050"),each = 3),
xpd = NA,
## Rotate the labels by 35 degrees.
srt = 35,
adj = 0.8,
cex = 1.2)
barplot(re, beside = T,ylim = c(-0.01,0.65),
cex.names = 2,axes = F,axisnames = F,xlab = NULL,ylab = NULL,col = color)
axis(side = 1, at = seq(1.5,11.5,1), labels = F)
text(x = seq(1.5,11.5,1)[-c(4,8)],
labels = rep(c("f001","f002","x9472050"),each = 3),
## Rotate the labels by 35 degrees.
srt = 35,
adj = 0.8,
cex = 1.2)
axis(side = 2, las = 1)
box()
text(x = seq(1.5,11.5,1)[-c(4,8)],
y = par("usr")[3] - 0.5,
labels = rep(c("f001","f002","x9472050"),each = 3),
xpd = NA,
## Rotate the labels by 35 degrees.
srt = 35,
adj = 0.8,
cex = 1.2)
par("usr")[3] - 0.5
par("usr")[3]
par("usr")
text(x = seq(1.5,11.5,1)[-c(4,8)],
y = par("usr")[1],
labels = rep(c("f001","f002","x9472050"),each = 3),
xpd = NA,
## Rotate the labels by 35 degrees.
srt = 35,
adj = 0.8,
cex = 1.2)
text(x = seq(1.5,11.5,1)[-c(4,8)],
y = par("usr")[2],
labels = rep(c("f001","f002","x9472050"),each = 3),
xpd = NA,
## Rotate the labels by 35 degrees.
srt = 35,
adj = 0.8,
cex = 1.2)
text(x = seq(1.5,11.5,1)[-c(4,8)],
y = par("usr")[2],
labels = rep(c("f001","f002","x9472050"),each = 3),
xpd = NA,
## Rotate the labels by 35 degrees.
srt = 35,
adj = 0.8,
cex = 1.2)
text(x = seq(1.5,11.5,1)[-c(4,8)],
y = par("usr")[3],
labels = rep(c("f001","f002","x9472050"),each = 3),
xpd = NA,
## Rotate the labels by 35 degrees.
srt = 35,
adj = 0.8,
cex = 1.2)
text(x = seq(1.5,11.5,1)[-c(4,8)],
y = par("usr")[3]-0.01,
labels = rep(c("f001","f002","x9472050"),3),
xpd = NA,
## Rotate the labels by 35 degrees.
srt = 30,
adj = 0.8,
cex = 1.2)
barplot(re, beside = T,ylim = c(-0.01,0.65),
cex.names = 2,axes = F,axisnames = F,xlab = NULL,ylab = NULL,col = color)
axis(side = 1, at = seq(1.5,11.5,1), labels = F)
text(x = seq(1.5,11.5,1)[-c(4,8)],
y = par("usr")[3]-0.01,
labels = rep(c("f001","f002","x9472050"),3),
xpd = NA,
## Rotate the labels by 35 degrees.
srt = 30,
adj = 0.8,
cex = 1.2)
text(x = seq(1.5,11.5,1)[-c(4,8)],
y = par("usr")[3]-0.05,
labels = rep(c("f001","f002","x9472050"),3),
xpd = NA,
## Rotate the labels by 35 degrees.
srt = 30,
adj = 0.8,
cex = 1.2)
barplot(re, beside = T,ylim = c(-0.01,0.65),
cex.names = 2,axes = F,axisnames = F,xlab = NULL,ylab = NULL,col = color)
axis(side = 1, at = seq(1.5,11.5,1), labels = F)
text(x = seq(1.5,11.5,1)[-c(4,8)],
y = par("usr")[3]-0.03,
labels = rep(c("f001","f002","x9472050"),3),
xpd = NA,
## Rotate the labels by 35 degrees.
srt = 30,
adj = 0.8,
cex = 1.2)
axis(side = 2, las = 1)
box()
legend(0,0.6, legend = toupper(vegname[i]), bty = "n")
par(mfrow = c(1,3))
par(oma = c(2,2,1,1), mar = c(2,2,1,1))
color = rep(colorname,each=3) #colorname
for( i in 1:length(vegname) ){
idx = which(rownames(veg_fl) == vegname[i])
re = veg_fl[idx,] #fl[[i]]
barplot(re, beside = T,ylim = c(-0.01,0.65),
cex.names = 2,axes = F,axisnames = F,xlab = NULL,ylab = NULL,col = color)
axis(side = 1, at = seq(1.5,11.5,1), labels = F)
text(x = seq(1.5,11.5,1)[-c(4,8)],
y = par("usr")[3]-0.03,
labels = rep(c("f001","f002","x9472050"),3),
xpd = NA,
## Rotate the labels by 35 degrees.
srt = 30,
adj = 0.8,
cex = 1.2)
axis(side = 2, las = 1)
box()
legend(0,0.6, legend = toupper(vegname[i]), bty = "n")
}
text(x = seq(1.5,11.5,1)[-c(4,8)],
y = par("usr")[3]-0.03,
labels = rep(c("f001","f002","x9472050"),3),
xpd = NA,
## Rotate the labels by 35 degrees.
srt = 30,
adj = 0.6,
cex = 1.2)
text(x = seq(1.5,11.5,1)[-c(4,8)],
y = par("usr")[3]-0.03,
labels = rep(c("f001","f002","x9472050"),3),
xpd = NA,
## Rotate the labels by 35 degrees.
srt = 35,
adj = 0.6,
cex = 1.2)
par(mfrow = c(1,3))
par(oma = c(2,2,1,1), mar = c(2,2,1,1))
color = rep(colorname,each=3) #colorname
for( i in 1:length(vegname) ){
idx = which(rownames(veg_fl) == vegname[i])
re = veg_fl[idx,] #fl[[i]]
barplot(re, beside = T,ylim = c(-0.01,0.65),
cex.names = 2,axes = F,axisnames = F,xlab = NULL,ylab = NULL,col = color)
axis(side = 1, at = seq(1.5,11.5,1), labels = F)
text(x = seq(1.5,11.5,1)[-c(4,8)],
y = par("usr")[3]-0.03,
labels = rep(c("f001","f002","x9472050"),3),
xpd = NA,
## Rotate the labels by 35 degrees.
srt = 35,
adj = 0.6,
cex = 1.2)
axis(side = 2, las = 1)
box()
legend(0,0.6, legend = toupper(vegname[i]), bty = "n")
}
plot(1:20,pch = 1:20)
legend(0,0.4,legend = toupper(substr(percname),6,11), col = colorname, pch = 16)
legend(0,0.4,legend = toupper(substr(percname,6,11)), col = colorname, pch = 16)
par(mfrow = c(1,3))
par(oma = c(2,2,1,1), mar = c(2,2,1,1))
color = rep(colorname,each=3) #colorname
for( i in 1:length(vegname) ){
idx = which(rownames(veg_fl) == vegname[i])
re = veg_fl[idx,] #fl[[i]]
barplot(re, beside = T,ylim = c(-0.01,0.65),
cex.names = 2,axes = F,axisnames = F,xlab = NULL,ylab = NULL,col = color)
axis(side = 1, at = seq(1.5,11.5,1), labels = F)
text(x = seq(1.5,11.5,1)[-c(4,8)],
y = par("usr")[3]-0.03,
labels = rep(c("f001","f002","x9472050"),3),
xpd = NA,
## Rotate the labels by 35 degrees.
srt = 35,
adj = 0.6,
cex = 1.2)
axis(side = 2, las = 1)
box()
legend(0,0.6, legend = toupper(vegname[i]), bty = "n")
if(i == 1){
legend(0,0.4,legend = toupper(substr(percname,6,11)), col = colorname, pch = 16, bty = "n")
}
}
par(mfrow = c(1,3))
par(oma = c(2,2,1,1), mar = c(2,2,1,1))
color = rep(colorname,each=3) #colorname
for( i in 1:length(vegname) ){
idx = which(rownames(veg_fl) == vegname[i])
re = veg_fl[idx,] #fl[[i]]
barplot(re, beside = T,ylim = c(-0.01,0.65),
cex.names = 2,axes = F,axisnames = F,xlab = NULL,ylab = NULL,col = color)
axis(side = 1, at = seq(1.5,11.5,1), labels = F)
text(x = seq(1.5,11.5,1)[-c(4,8)],
y = par("usr")[3]-0.03,
labels = rep(c("f001","f002","x9472050"),3),
xpd = NA,
## Rotate the labels by 35 degrees.
srt = 35,
adj = 0.6,
cex = 1.2)
axis(side = 2, las = 1)
box()
legend(0,0.6, legend = toupper(vegname[i]), bty = "n")
if(i == 1){
legend(0,0.5,legend = percname, col = colorname, pch = 15, bty = "n", x.intersp = 0.3)
}
}
?legend
legend(0,0.5,legend = percname, col = colorname, border = "black", pch = 15, bty = "n", x.intersp = 0.3)
for( i in 1:length(vegname) ){
idx = which(rownames(veg_fl) == vegname[i])
re = veg_fl[idx,] #fl[[i]]
barplot(re, beside = T,ylim = c(-0.01,0.65),
cex.names = 2,axes = F,axisnames = F,xlab = NULL,ylab = NULL,col = color)
axis(side = 1, at = seq(1.5,11.5,1), labels = F)
text(x = seq(1.5,11.5,1)[-c(4,8)],
y = par("usr")[3]-0.03,
labels = rep(c("f001","f002","x9472050"),3),
xpd = NA,
## Rotate the labels by 35 degrees.
srt = 35,
adj = 0.6,
cex = 1.2)
axis(side = 2, las = 1)
box()
legend(0,0.6, legend = toupper(vegname[i]), bty = "n")
if(i == 1){
legend(0,0.5,legend = percname, col = colorname, border = "black", pch = 15, bty = "n", x.intersp = 0.3)
}
}
par(mfrow = c(1,3))
par(oma = c(2,2,1,1), mar = c(2,2,1,1))
color = rep(colorname,each=3) #colorname
for( i in 1:length(vegname) ){
idx = which(rownames(veg_fl) == vegname[i])
re = veg_fl[idx,] #fl[[i]]
barplot(re, beside = T,ylim = c(-0.01,0.65),
cex.names = 2,axes = F,axisnames = F,xlab = NULL,ylab = NULL,col = color)
axis(side = 1, at = seq(1.5,11.5,1), labels = F)
text(x = seq(1.5,11.5,1)[-c(4,8)],
y = par("usr")[3]-0.03,
labels = rep(c("f001","f002","x9472050"),3),
xpd = NA,
## Rotate the labels by 35 degrees.
srt = 35,
adj = 0.6,
cex = 1.2)
axis(side = 2, las = 1)
box()
legend(0,0.6, legend = toupper(vegname[i]), bty = "n")
if(i == 1){
legend(0,0.5,legend = percname, col = colorname, pch = 15, bty = "n", x.intersp = 0.3)
}
}
data_year = calc_annual(data)
plt_multi_fl(get_perc_veg_cor, data, flname)
plt_multi_fl <- function(func, data, flname){
flname = c("f001","f002","x9472050")
vegname = c("ndvi","evi","lai")
percname = c("perc_t1c0f1","perc_t0c0f0","perc_t1c1f1")
col_t1c0f1 = rgb(0,0,1,0.7)
col_t0c0f0 = rgb(1,0.1,0,0.7)
col_t1c1f1 = rgb(0,1,0,0.7)
colorname = c(col_t1c0f1,col_t0c0f0,col_t1c1f1)
veg_fl = NULL
fl = matrix(list(),1,3)
for( i in 1:length(vegname) ){
for( fli in 1:length(flname) ){
fl[[fli]] = func(data, flname[fli],percname)
veg_fl = rbind(veg_fl,fl[[fli]][i,])
}
}
rownames(veg_fl) = rep(vegname,each=3)
par(mfrow = c(1,3))
par(oma = c(2,2,1,1), mar = c(2,2,1,1))
color = rep(colorname,each=3) #colorname
for( i in 1:length(vegname) ){
idx = which(rownames(veg_fl) == vegname[i])
re = veg_fl[idx,] #fl[[i]]
barplot(re, beside = T,ylim = c(-0.01,0.65),
cex.names = 2,axes = F,axisnames = F,xlab = NULL,ylab = NULL,col = color)
axis(side = 1, at = seq(1.5,11.5,1), labels = F)
text(x = seq(1.5,11.5,1)[-c(4,8)],
y = par("usr")[3]-0.03,
labels = rep(flname,3),
xpd = NA,
## Rotate the labels by 35 degrees.
srt = 35,
adj = 0.6,
cex = 1.2)
axis(side = 2, las = 1)
box()
legend(0,0.6, legend = toupper(vegname[i]), bty = "n")
if(i == 1){
legend(0,0.5,legend = percname, col = colorname, pch = 15, bty = "n", x.intersp = 0.3)
}
}
}
get_perc_veg_cor <- function(data, flname,percname, flname_veg = NULL){
if (is.null(flname_veg)){
flname_veg = flname
}
daily_cor = matrix(NA,length(vegname),length(percname))
vegname = c("ndvi","evi","lai")
for (i in 1:length(vegname)){
for (j in 1:length(percname)){
tperc = data[[percname[j]]][,flname]
tveg = data[[vegname[i]]][, flname_veg]
daily_cor[i,j] = cor(tperc, tveg, use = "pairwise")
}
}
colnames(daily_cor) = percname
rownames(daily_cor) = vegname
return(daily_cor)
}
plt_multi_fl(get_perc_veg_cor, data, flname)
plt_multi_fl(get_perc_veg_cor, data_year, flname)
data_year = calc_annual(data)$annual
plt_multi_fl(get_perc_veg_cor, data_year, flname)
###################
source('assist_figure_daily.R')
plt_multi_fl(get_perc_veg_cor, data, flname)
plt_multi_fl(get_perc_veg_cor, data_year, flname)
###################
source('assist_figure_daily.R')
plt_multi_fl(get_perc_veg_cor, data_year, flname)
###################
source('assist_figure_multifl_cor.R')
plt_multi_fl(get_perc_veg_cor, data, flname)
plt_multi_fl(get_perc_veg_cor, data_year, flname)
###################
source('assist_figure_multifl_cor.R')
plt_multi_fl(get_perc_veg_cor, data, flname)
plt_multi_fl(get_perc_veg_cor, data_year, flname)
plt_residue_box(data_residue, flname)
# calculate residue
source("calc_residue.R")
data_residue = calc_residue(data)
plt_residue_box(data_residue, flname)
data = loaddata(datadir);
# calculate residue
source("calc_residue.R")
data_residue = calc_residue(data)
stat = plt_residue_box(data_residue, flname)
for (j in 1:length(percname)){
for (i in 1:length(resname)){
idx_b = which(data_residue[[resname[i]]][,flname]>0)
idx_s = which(data_residue[[resname[i]]][,flname]<0)
tperc_b = data_residue[[percname[j]]][idx_b,flname]
tperc_s = data_residue[[percname[j]]][idx_s,flname]
stat$ttest_p[j, i]= t.test(tperc_b, tperc_s)$p.value
stat$cohen_d[j, i]= cohen.d(tperc_b, tperc_s)$estimate
plt_box(tperc_b,tperc_s,colorname[j])
if( j == 1 ){
mtext(side = 3, line = 0.5, text = toupper(vegname[i]) )
}
#if( j == 3 ){
mtext(side = 1, line = 0.8, at = c(0.5,1.5), text = c("res>0","res<0"))
#}
if( i == 1 ){
mtext(side = 2, line = 2.4, text = percname[j])
}
}
}
j
i
idx_b = which(data_residue[[resname[i]]][,flname]>0)
idx_s = which(data_residue[[resname[i]]][,flname]<0)
tperc_b = data_residue[[percname[j]]][idx_b,flname]
tperc_s = data_residue[[percname[j]]][idx_s,flname]
stat$ttest_p[j, i]= t.test(tperc_b, tperc_s)$p.value
stat$cohen_d[j, i]= cohen.d(tperc_b, tperc_s)$estimate
cohen.d(tperc_b, tperc_s)
tperc_b
percname
flname
flname = "f001"
stat = plt_residue_box(data_residue, flname)
stat
###################
source('assist_figure_residue.R')
flname = "f001"
stat = plt_residue_box(data_residue, flname)
stat
stat$cohen_d
plt_residue_box(data_residue, flname)
###################
source('assist_figure_multifl_cor.R')
## residue
plt_multi_fl(plt_residue_box, data_residue, flname, isres = 0)
get_perc_veg_cor(data, "f001")
t(get_perc_veg_cor(data, "f001"))
###################
source('assist_figure_multifl_cor.R')
## residue
plt_multi_fl(plt_residue_box, data_residue, flname, isres = 0)
func = plt_residue_box
flname = c("f001","f002","x9472050")
vegname = c("ndvi","evi","lai")
percname = c("perc_t1c0f1","perc_t0c0f0","perc_t1c1f1")
col_t1c0f1 = rgb(0,0,1,0.7)
col_t0c0f0 = rgb(1,0.1,0,0.7)
col_t1c1f1 = rgb(0,1,0,0.7)
colorname = c(col_t1c0f1,col_t0c0f0,col_t1c1f1)
veg_fl = NULL
fl = matrix(list(),1,3)
for( i in 1:length(vegname) ){
for( fli in 1:length(flname) ){
if(isres == 0){
fl[[fli]] = func(data, flname[fli])
}else if(isres == 1){
fl[[fli]] = t(func(data, flname[fli])$cohen_d)
}
veg_fl = rbind(veg_fl,fl[[fli]][i,])
}
}
isres=1
for( i in 1:length(vegname) ){
for( fli in 1:length(flname) ){
if(isres == 0){
fl[[fli]] = func(data, flname[fli])
}else if(isres == 1){
fl[[fli]] = t(func(data, flname[fli])$cohen_d)
}
veg_fl = rbind(veg_fl,fl[[fli]][i,])
}
}
t(func(data, flname[fli])$cohen_d)
t(func(data_residue, flname[fli])$cohen_d)
for( i in 1:length(vegname) ){
for( fli in 1:length(flname) ){
if(isres == 0){
fl[[fli]] = func(data, flname[fli])
}else if(isres == 1){
fl[[fli]] = t(func(data_residue, flname[fli])$cohen_d)
}
veg_fl = rbind(veg_fl,fl[[fli]][i,])
}
}
veg_fl
rownames(veg_fl) = rep(vegname,each=3)
par(mfrow = c(1,3))
par(oma = c(2,2,1,1), mar = c(2,2,1,1))
color = rep(colorname,each=3) #colorname
for( i in 1:length(vegname) ){
idx = which(rownames(veg_fl) == vegname[i])
re = veg_fl[idx,] #fl[[i]]
barplot(re, beside = T,ylim = c(-0.01,0.65),
cex.names = 2,axes = F,axisnames = F,xlab = NULL,ylab = NULL,col = color)
axis(side = 1, at = seq(1.5,11.5,1), labels = F)
text(x = seq(1.5,11.5,1)[-c(4,8)],
y = par("usr")[3]-0.03,
labels = rep(flname,3),
xpd = NA,
## Rotate the labels by 35 degrees.
srt = 35,
adj = 0.6,
cex = 1.2)
axis(side = 2, las = 1)
box()
legend(0,0.6, legend = toupper(vegname[i]), bty = "n")
if(i == 1){
legend(0,0.55,legend = percname, col = colorname, pch = 15, bty = "n", x.intersp = 0.3)
}
}
for( i in 1:length(vegname) ){
idx = which(rownames(veg_fl) == vegname[i])
re = veg_fl[idx,] #fl[[i]]
barplot(re, beside = T,ylim = c(-0.01,0.65),
cex.names = 2,axes = F,axisnames = F,xlab = NULL,ylab = NULL,col = color)
axis(side = 1, at = seq(1.5,11.5,1), labels = F)
text(x = seq(1.5,11.5,1)[-c(4,8)],
y = par("usr")[3]-0.03,
labels = rep(flname,3),
xpd = NA,
## Rotate the labels by 35 degrees.
srt = 35,
adj = 0.6,
cex = 1.2)
axis(side = 2, las = 1)
box()
legend(0,0.6, legend = toupper(vegname[i]), bty = "n")
if(i == 1){
#legend(0,0.55,legend = percname, col = colorname, pch = 15, bty = "n", x.intersp = 0.3)
}
}
###################
source('assist_figure_multifl_cor.R')
source('assist_figure_residue.R')
## residue
plt_multi_fl(plt_residue_box, data_residue, flname, isres = 0)
## residue
plt_multi_fl(plt_residue_box, data_residue, flname, isres = 1)
